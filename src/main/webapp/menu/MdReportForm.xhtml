<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:b="http://bootsfaces.net/ui" xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:body>
	<ui:composition template="/template/common/commonLayout.xhtml">

		<ui:define name="content">
			
			<div class="panel-heading">
				<center>
					<span class="glyphicon glyphicon-user"></span>#{msg['message.header.report4.info']}
				</center>
			</div>

			<h:form>
				<!-- 				<div class="panel panel-info"> -->
				<div class="panel panel-primary ">
					<div class="panel-heading">CHOOSE THE FORMAT OF THE REPORT
						YOU WANT.</div>
					<div class="panel-body"
						style="border: 0px solid blue; margin-top: 4px; height: 750px; font-family: Open Sans sans-serif !important; font-size: 14px !important;">
						<!-- 						<h:form> -->
						<h:panelGroup layout="block"
							rendered="#{not mdReportActivity.valid and not facesContext.validationFailed}">
							<ul>
								<ui:repeat value="#{facesContext.messageList}"
									var="facesMessage">
									<li class="alert alert-danger"
										style="list-style: none; background-color: #FF2400; color: white">
										<center>
											<h:outputText value="#{facesMessage.summary}" escape="false" />
										</center>
									</li>
								</ui:repeat>
							</ul>
						</h:panelGroup>

						<h:panelGroup layout="block"
							rendered="#{mdReportActivity.valid and  not facesContext.validationFailed}">
							<ul>
								<ui:repeat value="#{facesContext.messageList}"
									var="facesMessage">
									<li
										style="list-style: none; background-color: #32CD32; color: white; margin-left: -4.9%"
										class="alert alert-success"><h:outputText
											value="#{facesMessage.summary}" escape="false" /></li>
								</ui:repeat>
							</ul>
						</h:panelGroup>
						<!--  -->
						<h:panelGroup id="countryPanel" layout="block" rendered="true">
							<div class="form-group row">
								<label for="todate"
									class="col-md-2 col-sm-2 col-xs-2 control-label"
									style="color: black">#{msg['form.report.format']}<span
									style="color: red">*</span></label>
								<!-- <div class="col-md-6 col-sm-6 col-xs-6"> -->

								<table class="table table-hover" id="countryId"
									styleClass="form-control"
									style="font-size: 15px; font-family: Times New Roman; width: 50%; margin-left: 20px;">
									<tbody class="details">

										<tr class="warning">
											<td colspan="2"><h:selectOneRadio id="countryId"
													styleClass="form-control"
													style="font-family: Open Sans sans-serif !important; font-size: 15px !important;margin-top:18px; margin-left:0%;"
													value="#{mdReportActivity.myChoice}">
													<p:ajax listener="#{mdReportActivity.updateTable()}"
														update="forpdf,firstpanel,secondpanel,forexcel,seventhpanel,forcleareTable
																			chartpanel,forchart,psdfViewpanel,chartpanelboard,forchartboard" />
													<f:ajax onevent="showProgress" />
													<f:selectItem
														itemLabel="&nbsp;PDF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
														itemValue="PDF" />
													<f:selectItem
														itemLabel="&nbsp;EXCEL  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
														itemValue="Excel" />
													<f:selectItem itemLabel="&nbsp;View chart &nbsp;"
														itemValue="Chart" />
													<f:selectItem itemLabel="&nbsp;Clrearance report &nbsp;"
														itemValue="Clearance" />
												</h:selectOneRadio></td>
										</tr>

									</tbody>

								</table>
								<!-- </div> -->
							</div>

							<div>
								<h:message for="countryId" styleClass="help-block"></h:message>
							</div>
						</h:panelGroup>

						<h:panelGroup id="firstpanel" layout="block">
							<p:outputPanel id="toUpdatss" autoUpdate="true"
								rendered="#{mdReportActivity.rendered}">
								<h:panelGroup id="forpdf" layout="block">
									<div class="form-group row">

										<div class="col-md-6 col-sm-6 col-xs-6"></div>
										<div class="panel-body">

											<div class="form-group row">
												<label for="todate"
													class="col-md-2 col-sm-2 col-xs-2 control-label"
													style="color: black">#{msg['form.task.parentBoard']}</label>
												<div class="col-md-4 col-sm-4 col-xs-4">
													<h:selectOneMenu id="cate" styleClass="form-control"
														required="true" value="#{mdReportActivity.selectedBoard}"
														requiredMessage="#{msg['parent.task.required']}">
														<p:ajax listener="#{mdReportActivity.repfoboard()}"
															update="psdfViewpanel" />

														<f:selectItem
															itemLabel="#{msg['common.message.select.PLACEHOLDER']}"
															itemValue="#{null}" escapeItem="true" />
														<f:selectItems value="#{mdReportActivity.boardDetails}"
															var="option" itemValue="#{option.boardId}"
															itemLabel="#{option.boardName}" itemLabelEscaped="true" />

													</h:selectOneMenu>

												</div>
												<div class="col-md-2 col-sm-2 col-xs-2"
													style="margin-left: 20px">
													<h:commandButton class="btn btn-success btn-md btn-block"
														action="#{mdReportActivity.createPdf}"
														value="#{msg['label.submit.message.printPdfr']}" />
												</div>
											</div>
										</div>
									</div>

								</h:panelGroup>

							</p:outputPanel>
						</h:panelGroup>

						<h:panelGroup id="secondpanel" layout="block">
							<p:outputPanel id="toUpdat" autoUpdate="true"
								rendered="#{mdReportActivity.renderedx}">
								<h:panelGroup id="forexcel" layout="block">
									<div class="form-group row">
										<div class="col-md-6 col-sm-6 col-xs-6"></div>
										<div class="panel-body">
											<div class="form-group row">
												<label for="todate"
													class="col-md-2 col-sm-2 col-xs-2 control-label"
													style="color: black">#{msg['form.task.parentBoard']}</label>
												<div class="col-md-4 col-sm-4 col-xs-4">
													<h:selectOneMenu id="cates" styleClass="form-control"
														required="true" value="#{mdReportActivity.selectedBoard}"
														requiredMessage="#{msg['parent.task.required']}">
														<p:ajax listener="#{mdReportActivity.repfoboard()}"
															update="psdfViewpanel" />
														<f:selectItem
															itemLabel="#{msg['common.message.select.PLACEHOLDER']}"
															itemValue="#{null}" escapeItem="true" />
														<f:selectItems value="#{mdReportActivity.boardDetails}"
															var="option" itemValue="#{option.boardId}"
															itemLabel="#{option.boardName}" itemLabelEscaped="true" />
													</h:selectOneMenu>
												</div>
												<div class="col-md-2 col-sm-2 col-xs-2"
													style="margin-left: 20px">
													<h:commandButton class="btn btn-success btn-md btn-block"
														action="#{mdReportActivity.printXLS}"
														value="#{msg['label.submit.message.printPdfx']}" />
												</div>

											</div>

										</div>
									</div>
								</h:panelGroup>
							</p:outputPanel>
						</h:panelGroup>

						<!-- CODES FOR TABLE PDF PANEL -->

						<h:panelGroup id="psdfViewpanel" layout="block">
							<p:outputPanel
								rendered="#{mdReportActivity.renderEditedTableByBoard}">
								<div class=" col-md-12"
									style="height: 330px; overflow-y: scroll;">
									<h:dataTable id="taskAssignTable" binding="#{table}"
										style="font: italic 14px/18px Georgia, serif;box-sizing: border-box; width:100% !important;
       						 -webkit-box-shadow: none; box-shadow: none !important; margin: 17px 5px 0 !important;"
										value="#{mdReportActivity.activityMddtodetails}" var="info"
										class="table table-striped table-hover table-bordered tableUpdated ">
										<f:facet name="header">
											<label
												style="margin-left: 35%; font: italic bold 16px/20px Georgia, serif;">#{msg['form.activity.task.performance']}</label>
											<div aria-label="Basic example">
												<h:commandLink data-toggle="tooltip" data-placement="left"
													title="#{msg['viewactivity.statisButton']}"
													class="btn btn-md btn-primary glyphicon glyphicon-stats"
													action="#{mdReportActivity.showStatistics}">
												</h:commandLink>
											</div>

										</f:facet>

										<h:column>
											<f:facet name="header">
												<label>No</label>
											</f:facet>
											<br />
											<h:outputText value="#{table.rowIndex + 1}" />
										</h:column>
										<h:column>
											<f:facet name="header">
												<label>Target name</label>
											</f:facet>
											<br />
											<h:outputText value="#{info.taskName}">
											</h:outputText>

										</h:column>
										<h:column>
											<f:facet name="header">
												<label>Target weight</label>
											</f:facet>
											<br />
											<h:outputText value="#{info.taskWeight}">
											</h:outputText>

										</h:column>

										<h:column>
											<f:facet name="header">
												<label>Assigned date</label>
											</f:facet>
											<br />
											<h:outputText value="#{info.startDate}" />
										</h:column>
										<h:column>
											<f:facet name="header">
												<label>Due date</label>
											</f:facet>
											<br />
											<h:outputText value="#{info.dueDate}" />
										</h:column>
										<h:column>
											<f:facet name="header">
												<label>End date</label>
											</f:facet>
											<br />
											<h:outputText value="#{info.endDate}" />
										</h:column>

									</h:dataTable>
								</div>
								<p:autoUpdate />

							</p:outputPanel>
						</h:panelGroup>
						<!-- END -->



						<h:panelGroup id="chartpanel" layout="block">
							<p:outputPanel id="toUpdates" autoUpdate="true"
								rendered="#{mdReportActivity.renderedchart}">
								<h:panelGroup id="forchart" layout="block">


									<!-- CODES TO GENERATE THE CHART FOR THE OVERALL -->
									<h:body>
										<script
											src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js">
											
										</script>
										<meta http-equiv="Content-Type"
											content="text/html; charset=utf-8" />
										<style type="text/css">
@media ( max-width :960) {
	.myChartDiv {
		width: 100%;
	}
}
</style>
										<!-- <h1 style="margin-top: 150px;">Reporting Graph</h1> -->
										<div id="orgChartContainer">
											<div id="orgChart"></div>
										</div>
										<div id="consoleOutput">
											<h1 style="margin-left: 200PX">The clearance report on
												graph</h1>
											<div class="myChartDiv" style="width: 900px;">
												<canvas id="myChart"> </canvas>
											</div>

											<h:form class="form-horizontal">
												<div class="form-group">
													<h:outputLabel class="col-lg-2"></h:outputLabel>
													<div class="col-lg-8">

														<h:inputText class="name" style="display:none;"
															value="#{charController.name}"></h:inputText>
													</div>
												</div>

												<!-- This is another form -->
											</h:form>
										</div>
										<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
										<script
											src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
										<script>
											$(function() {

												var j;
												var ctx = document
														.getElementById(
																'myChart')
														.getContext('2d');
												var replacedData = $(".name")
														.val();
												var req = replacedData.replace(
														"id", "x");
												req.replace("Rate", "y");
												console.log(req);

												var value = [];
												var p = [];
												var comp = [];
												var labels = [];
												function recusive(n, testData,
														n2) {
													if (n2 >= n) {
														value
																.push(testData[n].numberOfActivities);
														p
																.push(testData[n].approved);
														comp
																.push(testData[n].completed);
														labels
																.push(testData[n].taskName);
														recusive(n + 1,
																testData, n2);
													}
												}

												var testData = JSON.parse($(
														".name").val());
												console
														.log(testData[0].taskName);
												recusive(0, testData,
														testData.length - 1);
												console.log(value);

												var myLineChart = new Chart(
														ctx,
														{
															type : 'bar',
															data : {
																labels : labels,
																datasets : [
																		{
																			label : "Planned ",
																			data : value,
																			backgroundColor : '#0318CF',
																		},
																		{
																			label : "Approved",
																			data : p,
																			backgroundColor : '#29C3BE',
																		},
																		{
																			label : "Completed",
																			data : comp,
																			backgroundColor : '#c328a4',
																		} ]
															},
															options : {
																elements : {
																	line : {
																		tension : 0, // disables bezier curves
																	}
																}
															}
														});
											});
										</script>
									</h:body>

								</h:panelGroup>
							</p:outputPanel>
						</h:panelGroup>

						<!-- END OF THE GRAPH PRESENTATION -->

						<h:panelGroup id="seventhpanel" layout="block">
							<p:outputPanel id="toUpdetcltable" autoUpdate="true"
								rendered="#{mdReportActivity.renderedclear}">
								<h:panelGroup id="forcleareTable" layout="block">
									<div class="form-group row">

										<div class="col-md-6 col-sm-6 col-xs-6"></div>
										<div class="panel-body">
											<p:dataTable id="tabl" var="a"
												value="#{staffReport.clearanceDtoDetails}" scrollable="true"
												scrollHeight="200" sortOrder="descending">
												<f:facet name="header">
												
												Clearance for planned and completed activities </f:facet>
												<!-- <p:column width="50"> #{a.strategicplan}<f:facet
														name="header">Strategic plan</f:facet>
												</p:column> -->
												<p:column width="50"> #{a.taskName}<f:facet
														name="header">Task</f:facet>
												</p:column>
												<p:column width="50"> #{a.numberOfActivities}<f:facet
														name="header">Planned</f:facet>
												</p:column>
												<p:column width="50"> #{a.notStarted}<f:facet
														name="header">Not started</f:facet>
												</p:column>
												
												<!-- <p:column width="50"> #{a.pending}<f:facet
														name="header">Pending</f:facet>
												</p:column> -->

												<p:column width="50"> #{a.completed}<f:facet
														name="header">Completed</f:facet>
												</p:column>

												<p:column width="50"> #{a.rate}%<f:facet
														name="header">Rate</f:facet>
												</p:column>

											</p:dataTable>
											<div class="col-md-2 col-sm-2 col-xs-2">
												<h:commandButton class="btn btn-success btn-md btn-block"
													action="#{staffReport.myClearance}" value="View in table">
													<f:ajax render="@form" execute="@form"
														onevent="showProgress" />
												</h:commandButton>
											</div>
											<h:form>
												<div class="col-md-2 col-sm-2 col-xs-2"
													style="margin-left: 80px">
													<h:commandButton class="btn btn-success btn-md btn-block"
														action="#{staffReport.createPDFfoClearance}"
														value="#{msg['label.submit.message.printPdf']}" />
												</div>
											</h:form>
										</div>
									</div>
								</h:panelGroup>
							</p:outputPanel>
						</h:panelGroup>




						<!--  CODES TO GENEARATE THE THE CHART FOR  SELECTED BOARD-->

						<h:panelGroup id="chartpanelboard" layout="block">
							<p:outputPanel id="toUpdatesbaord" autoUpdate="true"
								rendered="#{mdReportActivity.renderSelectedBoard}">
								<h:panelGroup id="forchartboard" layout="block">
									<h:body>
										<script
											src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js">
											
										</script>
										<meta http-equiv="Content-Type"
											content="text/html; charset=utf-8" />
										<style type="text/css">
@media ( max-width :960) {
	.myChartDiv {
		width: 100%;
	}
}
</style>
										<!-- <h1 style="margin-top: 150px;">Reporting Graph</h1> -->
										<div id="orgChartContainer">
											<div id="orgChart"></div>
										</div>
										<div id="consoleOutput">
											<!-- <h1 style="margin-left: 200PX">The clearance report on
												graph</h1> -->
											<div class="myChartDiv" style="width: 900px;">
												<canvas id="myChart"> </canvas>
											</div>

											<h:form class="form-horizontal">
												<div class="form-group">
													<h:outputLabel class="col-lg-2"></h:outputLabel>
													<div class="col-lg-8">

														<h:inputText class="name" style="display:none;"
															value="#{mdReportActivity.name}"></h:inputText>
													</div>
												</div>

												<!-- This is another form -->
											</h:form>
										</div>
										<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
										<script
											src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
										<script>
											$(function() {

												var j;
												var ctx = document
														.getElementById(
																'myChart')
														.getContext('2d');
												var replacedData = $(".name")
														.val();
												var req = replacedData.replace(
														"id", "x");
												req.replace("Rate", "y");
												console.log(req);

												var value = [];
												var p = [];
												var comp = [];
												var labels = [];
												function recusive(n, testData,
														n2) {
													if (n2 >= n) {
														value
																.push(testData[n].numberOfActivities);
														p
																.push(testData[n].approved);
														comp
																.push(testData[n].completed);
														labels
																.push(testData[n].taskName);
														recusive(n + 1,
																testData, n2);
													}
												}

												var testData = JSON.parse($(
														".name").val());
												console
														.log(testData[0].taskName);
												recusive(0, testData,
														testData.length - 1);
												console.log(value);

												var myLineChart = new Chart(
														ctx,
														{
															type : 'bar',
															data : {
																labels : labels,
																datasets : [
																		{
																			label : "Planned ",
																			data : value,
																			backgroundColor : '#0318CF',
																		},
																		{
																			label : "Approved",
																			data : p,
																			backgroundColor : '#29C3BE',
																		},
																		{
																			label : "Completed",
																			data : comp,
																			backgroundColor : '#c328a4',
																		} ]
															},
															options : {
																elements : {
																	line : {
																		tension : 0, // disables bezier curves
																	}
																}
															}
														});
											});
										</script>
									</h:body>

								</h:panelGroup>
							</p:outputPanel>
						</h:panelGroup>

						<!--  END OF CODES TO GENEARATE THE THE CHART FOR  SELECTED BOARD-->
					</div>
				</div>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>
</html>
























