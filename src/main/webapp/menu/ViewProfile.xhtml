<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
<h:body>

	<ui:composition template="/template/common/commonLayout.xhtml">

		<ui:define name="content">

			<div class="panel panel-default">

				<div class="panel-body"
					style="border: 0px solid blue; margin-top: 4px; height: auto; font-family: Open Sans sans-serif !important; font-size: 14px !important;">


					<h:form>
						<div class="form-group row">

							<div class="col-md-12 col-sm-12 col-xs-12">
								<!--error massage  -->
								<h:panelGroup layout="block"
									rendered="#{not userAccountController.valid and not facesContext.validationFailed}">
									<ul>
										<ui:repeat value="#{facesContext.messageList}"
											var="facesMessage">
											<li class="alert"
												style="list-style: none; background-color: #FF2400; color: white">
												<center>
													<h:outputText value="#{facesMessage.summary}"
														escape="false" />
												</center>
											</li>
										</ui:repeat>
									</ul>
								</h:panelGroup>
								<h:panelGroup layout="block"
									rendered="#{userAccountController.valid and  not facesContext.validationFailed}">
									<ul>
										<ui:repeat value="#{facesContext.messageList}"
											var="facesMessage">
											<li
												style="list-style: none; background-color: #32CD32; color: white; margin-left: -4.9%"
												class="alert alert-success"><center><h:outputText
													value="#{facesMessage.summary}" escape="false" /></center></li>
										</ui:repeat>
									</ul>
								</h:panelGroup>
							</div>

						</div>
						<table class="table table-hover"
							style="font-size: 15px; font-family: Times New Roman; width: 50%; margin-left: 20px;">
							<ui:repeat var="user"
								value="#{userAccountController.userDtoDetails}">

								<thead>
									<tr>
										<th colspan="2"><center>Account Information</center></th>
									</tr>
									<tr>
										<td bgcolor="#99b1bf"><label style="color: white;">Your
												Profile</label></td>

										<td bgcolor="#99b1bf"><label style="color: white;">Edit
												Your Profile</label></td>
									</tr>
								</thead>
								<tbody class="details">
									<tr>

										<td><img
											src="#{loadUserInformationsController.getContextPath()}/resources/userImages/#{loadUserInformationsController.users.image}"
											class="w3-circle" style="width: 20%; margin: 5px"
											alt="userImage" /></td>

										<td>
											<div class="fileupload fileupload-new"
												data-provides="fileupload">
												<div class="fileupload-preview thumbnail"
													style="width: 80%; height: 70px;"></div>
												<div>
													<span class="btn btn-file btn-success"><span
														class="fileupload-new">Select image</span><span
														class="fileupload-exists">Change</span> <p:fileUpload
															id="pict" value="#{fileUploadController.files}" mode="simple"
															allowTypes="/(\.|\/)(gif|jpe?g|png)$/" /> </span> <a href="#"
														class="btn btn-danger fileupload-exists"
														data-dismiss="fileupload">Remove</a>
												</div>
											</div>
										</td>

									</tr>
									<tr>

										<td colspan="2"><span><h:commandLink
													style="color:white"
													class="btn btn-success glyphicon glyphicon-edit"
													value="Edit"
													action="#{userAccountController.editAction(user)}"
													rendered="#{not user.editable}">
													<f:ajax render="@form" execute="@form"
														onevent="showProgress" />
												</h:commandLink></span> <h:commandLink style="margin-left:2px;color:white"
												class="btn btn-danger 	glyphicon glyphicon-remove"
												value="Cancel"
												action="#{userAccountController.cancel(user)}"
												rendered="#{user.editable}">
												<f:ajax render="@form" execute="@form"
													onevent="showProgress" />
											</h:commandLink></td>

									</tr>
									<tr>
										<td><br />FirstName:</td>
										<td><h:inputText value="#{user.fname}" size="20"
												required="true" rendered="#{user.editable}" id="fname"
												requiredMessage="#{msg['requiered.fname.message']}"
												converterMessage="#{msg['error.enter.invalid.fname']}"
												validatorMessage="#{msg['error.enter.invalid.fname']}">
												<f:validateRegex
													pattern="#{regex['regex.validation.message.VALID.FIRST_NAME']}"></f:validateRegex>
												<f:validateLength maximum="100"></f:validateLength>

											</h:inputText> <br /> <h:message errorClass="errorMsg1" for="fname"
												style="font-size:12px;font-family:Time New Roman;"></h:message>
											<h:outputText value="#{user.fname}"
												rendered="#{not user.editable}" /></td>
									</tr>
									<tr>
									
										<td><br />LastName:</td>
										<td><h:inputText value="#{user.lname}" size="20"
												id="lname" rendered="#{user.editable}" required="true"
												requiredMessage="#{msg['requiered.lname.message']}"
												converterMessage="#{msg['error.enter.invalid.lname']}"
												validatorMessage="#{msg['error.enter.invalid.lname']}">
												<f:validateRegex
													pattern="#{regex['regex.validation.message.VALID.FIRST_NAME']}"></f:validateRegex>
												<f:validateLength maximum="100"></f:validateLength>
											</h:inputText><br /> <h:message errorClass="errorMsg1" for="lname"
												style="font-size:12px;font-family:Time New Roman;"></h:message>
											<h:outputText value="#{user.lname}"
												rendered="#{not user.editable}" /></td>
									</tr>
									<tr>
										<td><br />Address:</td>
										<td><h:inputText value="#{user.address}" size="20"
												id="addr" rendered="#{user.editable}" required="true"
												requiredMessage="#{msg['requiered.address.message']}"
												converterMessage="#{msg['error_institution.enter.invalid.institutioAddress']}"
												validatorMessage="#{msg['error_institution.enter.invalid.institutioAddress']}">
												<f:validateRegex
													pattern="#{regex['regex.validation.message.VALID.FIRST_NAME']}"></f:validateRegex>
												<f:validateLength maximum="100"></f:validateLength>
											</h:inputText> <br /> <h:message errorClass="errorMsg1" for="addr"
												style="font-size:12px;font-family:Time New Roman;"></h:message>
											<h:outputText value="#{user.address}"
												rendered="#{not user.editable}" /></td>

									</tr>
									<!--Change Password option  -->
									<p:outputPanel id="yesOrNo"
										rendered="#{userAccountController.renderForeignCountry}"
										autoUpdate="true">
										<tr>
											<td><br />Do you want to change your password?:</td>
											<td><h:selectOneRadio style="margin-top:18px;"
													value="#{userAccountController.option}">
													<f:selectItem itemLabel="Yes" itemValue="yes" />
													<f:selectItem itemLabel="No" itemValue="no" />
													<f:ajax render="@form" execute="@form"
														onevent="showProgress"
														listener="#{userAccountController.changeOption()}" />
												</h:selectOneRadio></td>

										</tr>
									</p:outputPanel>

									<p:outputPanel id="changepswd"
										rendered="#{userAccountController.rendered}" autoUpdate="true">
										<tr>
											<td><br />Change Password:</td>
											<td><h:inputSecret
													 size="20"
													id="pswds" value="#{userAccountController.password}"
													maxlength="35" required="true"
													requiredMessage="#{msg['requiered.username.password']}">
													<f:validateRegex
														pattern="#{regex['regex.validation.message.VALID.FIRST_NAME']}"></f:validateRegex>
												</h:inputSecret> <br /> <h:message errorClass="errorMsg1" for="pswds"
													style="font-size:12px;font-family:Time New Roman;"></h:message>
											</td>

										</tr>
										<tr>
											<td><br />Confirm Password:</td>
											<td><h:inputSecret
													 size="20"
													id="confpswds" value="#{userAccountController.confirmPswd}"
													maxlength="35" required="true"
													requiredMessage="#{msg['requiered.username.confirmpassword']}">
													<f:validateRegex
														pattern="#{regex['regex.validation.message.VALID.FIRST_NAME']}"></f:validateRegex>
												</h:inputSecret> <br /> <h:message errorClass="errorMsg1" for="confpswds"
													style="font-size:12px;font-family:Time New Roman;"></h:message>
											</td>

										</tr>
									</p:outputPanel>
									<!-- End of change pswd -->
								</tbody>
							</ui:repeat>
						</table>
						<p:outputPanel id="toButton"
							rendered="#{userAccountController.renderForeignCountry}"
							autoUpdate="true">
							<h:commandButton value="Save Changes"
								styleClass="btn btn-primary" style="margin-left:20px;"
								action="#{userAccountController.saveAction(user)}">
								<f:ajax render="@form" execute="@form" onevent="showProgress" />
							</h:commandButton>
						</p:outputPanel>



					</h:form>
				</div>
			</div>
		</ui:define>
	</ui:composition>
</h:body>
</html>